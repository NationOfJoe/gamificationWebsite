<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: https://ogp.me/ns# fb: https://ogp.me/ns/fb#">
<html lang="en" class="js csstransforms3d">
<head>
  <meta charset="utf-8">
  <meta property="og:title" content="Spot Ocean Workshop" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="generator" content="Hugo 0.83.1" />
  <meta name="description" content="Spot Workshop">
<meta name="author" content="Amit Bar Oz, Zak Harabedian, Eric Knauer ">

  <link rel="shortcut icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />
<link rel="icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />

  <title>VNG Lab Continued :: Spot Ocean Workshop</title>

  
  <link href="../css/nucleus.css" rel="stylesheet">
  <link href="../css/fontawesome-all.min.css" rel="stylesheet">
  <link href="../css/hybrid.css" rel="stylesheet">
  <link href="../css/featherlight.min.css" rel="stylesheet">
  <link href="../css/perfect-scrollbar.min.css" rel="stylesheet">
  <link href="../css/auto-complete.css" rel="stylesheet">
  <link href="../css/atom-one-dark-reasonable.css" rel="stylesheet">
  <link href="../css/theme.css" rel="stylesheet">
  <link href="../css/hugo-theme.css" rel="stylesheet">
  
  <link href="../css/theme-aws.css" rel="stylesheet">
  

  <script src="../js/jquery-3.5.1.min.js"></script>

  <style>
    :root #header + #content > #left > #rlblock_left{
        display:none !important;
    }
    
      :not(pre) > code + span.copy-to-clipboard {
          display: none;
      }
    
  </style>
  
</head>

<body class="" data-url="../ocean-lab/vng_workshop.html">
  <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div>
    <a href="../" title="Go home">
        <img style="vertical-align:middle" src="https://spotlogo-public.s3.us-west-2.amazonaws.com/logo.png" height="70px" />
    </a>
</div>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../js/lunr.min.js"></script>
<script type="text/javascript" src="../js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="../js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/welcome.html" title="Welcome" class="dd-item 
        
        
        
        ">
      <a href="../welcome.html">
          Welcome
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/welcome/login.html" title="Agenda" class="dd-item 
        
        
        
        ">
      <a href="../welcome/login.html">
          Agenda
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/prerequisites.html" title="Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="../prerequisites.html">
          <b> </b>Prerequisites
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ocean_walkthrough.html" title="Ocean Creation" class="dd-item 
        
        
        
        ">
      <a href="../ocean_walkthrough.html">
          <b> </b>Ocean Creation
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ocean_walkthrough/ocean_creation.html" title="Ocean Cluster Creation" class="dd-item 
        
        
        
        ">
      <a href="../ocean_walkthrough/ocean_creation.html">
          <b> </b>Ocean Cluster Creation
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/ocean-lab.html" title="Ocean Workshop" class="dd-item 
        parent
        
        
        ">
      <a href="../ocean-lab.html">
          <b> </b>Ocean Workshop
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/ocean-lab/workshop_instructions.html" title="Workshop Instructions" class="dd-item 
        
        
        
        ">
      <a href="../ocean-lab/workshop_instructions.html">
          <b> </b>Workshop Instructions
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ocean-lab/vng_workshop.html" title="VNG Lab Continued" class="dd-item 
        parent
        active
        
        ">
      <a href="../ocean-lab/vng_workshop.html">
          <b> </b>VNG Lab Continued
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/ocean-lab/headroom.html" title="Headroom" class="dd-item 
        
        
        
        ">
      <a href="../ocean-lab/headroom.html">
          <b> </b>Headroom
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/conclusion.html" title="Conclusion" class="dd-item 
        
        
        
        ">
      <a href="../conclusion.html">
          <b></b>Conclusion
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/workshop.html" title="Hugo Workshop Notes" class="dd-item 
        
        
        
        ">
      <a href="../workshop.html">
          <b>X. </b>Hugo Workshop Notes
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/workshop/basics.html" title="Basics" class="dd-item 
        
        
        
        ">
      <a href="../workshop/basics.html">
          <b>1. </b>Basics
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/workshop/basics/requirements.html" title="Requirements" class="dd-item 
        
        
        
        ">
      <a href="../workshop/basics/requirements.html">
          Requirements
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/basics/installation.html" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="../workshop/basics/installation.html">
          Installation
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/basics/configuration.html" title="Configuration" class="dd-item 
        
        
        
        ">
      <a href="../workshop/basics/configuration.html">
          Configuration
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/cont.html" title="Content" class="dd-item 
        
        
        
        ">
      <a href="../workshop/cont.html">
          <b>2. </b>Content
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/workshop/cont/pages.html" title="Pages Organization" class="dd-item 
        
        
        
        ">
      <a href="../workshop/cont/pages.html">
          Pages Organization
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/cont/archetypes.html" title="Archetypes" class="dd-item 
        
        
        
        ">
      <a href="../workshop/cont/archetypes.html">
          Archetypes
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/cont/markdown.html" title="Markdown Syntax" class="dd-item 
        
        
        
        ">
      <a href="../workshop/cont/markdown.html">
          Markdown Syntax
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/cont/icons.html" title="Icons and Logos" class="dd-item 
        
        
        
        ">
      <a href="../workshop/cont/icons.html">
          Icons and Logos
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/cont/i18n.html" title="Multilingual and i18n" class="dd-item 
        
        
        
        ">
      <a href="../workshop/cont/i18n.html">
          Multilingual and i18n
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes.html" title="Shortcodes" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes.html">
          <b>3. </b>Shortcodes
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/attachments.html" title="Attachments" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/attachments.html">
          Attachments
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/button.html" title="Button" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/button.html">
          Button
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/children.html" title="Children" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/children.html">
          Children
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
             
            
          
             
            
          
             
            
          
             
            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/expand.html" title="Expand" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/expand.html">
          Expand
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/img.html" title="Image" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/img.html">
          Image
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/notice.html" title="Notice" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/notice.html">
          Notice
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/siteparam.html" title="Site param" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/siteparam.html">
          Site param
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/siteurl.html" title="Site URL" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/siteurl.html">
          Site URL
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/shortcodes/youtube.html" title="Youtube" class="dd-item 
        
        
        
        ">
      <a href="../workshop/shortcodes/youtube.html">
          Youtube
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/workshop/launch.html" title="Launch" class="dd-item 
        
        
        
        ">
      <a href="../workshop/launch.html">
          <b>4. </b>Launch
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/workshop/launch/metadata.html" title="Metadata" class="dd-item 
        
        
        
        ">
      <a href="../workshop/launch/metadata.html">
          Metadata
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <left>

    <a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | © 2021, Spot by NetApp, Inc. or its affiliates. All rights reserved. 

</left>

    </section>
  </div>
</nav>





  <section id="body">
    <div id="overlay"></div>
    <div class="padding highlightable">
      
      <div>
        <div id="top-bar">
          
          
          <div id="breadcrumbs" itemscope="" itemtype="https://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            
            <span class="links">
              
          
          
          
          
          
          
          
          
          
          
          <a href='../'>Spotlight User Conference</a> > <a href='../ocean-lab.html'>Ocean Workshop</a> > VNG Lab Continued
          
          
          
          
          
          
            </span>
          </div>
          
        </div>
      </div>
      

      
      <div id="chapter">
        
        <div id="body-inner">
          <h1>VNG Lab Continued</h1>
          
          


	<p>We now have our new VNG ready, let’s deploy our workload, in our examples we will deploy simple nginx Pods just to simulate the behaviour of Ocean alongside the Kubernetes Scheduler.
Create a file vng-example.yaml with the following content</p>

<figure>
	<img src="../ocean-lab/vng_workshop/vng-example.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>Apply the file using kubectl, run kubectl apply -f vng-example.yaml</p>

<figure>
	<img src="../ocean-lab/vng_workshop/2.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>List the pods,nodes from the cluster, you’ll be able to see the created Pod in a Pending state, run kubectl get pods,nodes</p>

<figure>
	<img src="../ocean-lab/vng_workshop/3.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>Following a couple of minutes, run kubectl get pods,nodes -o wide, we will see that a new node joined our cluster and that the Pod is being created/running on top of it</p>

<figure>
	<img src="../ocean-lab/vng_workshop/4.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>Describe the node to verify the nodeLabels are assigned to it</p>

<figure>
	<img src="../ocean-lab/vng_workshop/5.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>Tip - In addition to node labels you define, nodes come pre-populated with a standard set of labels. See Well-Known Labels, Annotations and Taints for a list of these.
Tip - Ocean expands the built in Kubernetes node-labels functionality with some proprietary labels supported by Ocean. See Labels &amp; Taints for further details.</p>
<p>We are now able to specify when we want to force a specific workload to run on machines of the example-1 VNG, in the current state, Pods with no specific constraints (e.g not directed toward specific type of nodes) might be placed on nodes from the example-1 VNG, in order to prevent that we will also need to assign a Taint to the VNG, the Pods that we want to run on the tainted VNG should Tolerate that Taint.</p>
<p>In order to demonstrate that, let’s add a new VNG, follow the same process but specify the following configurations - in the Name specify example-2, in the Node Selection section specify:
Node Labels
env: ocean-workshop
example: 2
Node Taints
Key: example
Value: 2
Effect: NoSchedule</p>

<figure>
	<img src="../ocean-lab/vng_workshop/6.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>Click the save button on the bottom of the page</p>
<p>Create a file vng-example-2.yaml file with the following content:</p>

<figure>
	<img src="../ocean-lab/vng_workshop/vng-example-2.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>While both Pods require our nodeLabels only one of them tolerates the node taints, let’s view it’s effect:
Run kubectl apply -f vng-example-2.yaml</p>

<figure>
	<img src="../ocean-lab/vng_workshop/7.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>We will now see that both our Pods are pending, Run kubectl get pods,nodes</p>

<figure>
	<img src="../ocean-lab/vng_workshop/8.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>A couple of minutes later Ocean will scale up a new machine to satisfy the supported Pod, we will see that only one of the Pods (example-2-1) will be scheduled while the other wont since it does not tolerate the nodes taint.</p>
<p>Run kubectl get pods,nodes -o wide</p>

<figure>
	<img src="../ocean-lab/vng_workshop/9.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>Run kubectl describe pod-name</p>
<p>Under the Events section you’ll see that the reason for the Pod not being scheduled is because there is a node with a taint that the pod did not tolerate</p>

<figure>
	<img src="../ocean-lab/vng_workshop/10.png?classes=shadow&width=60pc" alt="" />
</figure>
<p>To summarize the VNG section, VNGs allow us to separate our workloads if needed, it allows us to have different node configurations in the cluster and expands the benefits Ocean provides.</p>
<p>We covered the usage of various Kubernetes constraints, we learned how we can use nodeSelectors or Affinity/Anti-Affinity rules to force the required node from the Pod side and how a node can repel Pods from being scheduled on top of it, most importantly we learned how we can use those types of constraints while utilising Ocean VNGs.</p>
<p>Tip - You can use the Launch API calls to manually launch additional nodes within the VNG (AWS, GKE, AKS)
Tip - (Currently only available for AWS) On the creation of a VNG you can define the initalNodes url param to specify the initial number of nodes required in the VNG.</p>





<footer class=" footline" >
	
</footer>

        
            </div> 
        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
        
                    
                        
            
            
        
                    
                        
            
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../ocean-lab/workshop_instructions.html" title="Workshop Instructions"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../ocean-lab/headroom.html" title="Headroom" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../js/clipboard.min.js"></script>
    <script src="../js/perfect-scrollbar.min.js"></script>
    <script src="../js/perfect-scrollbar.jquery.min.js"></script>
    <script src="../js/jquery.sticky.js"></script>
    <script src="../js/featherlight.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../js/modernizr.custom-3.6.0.js"></script>
    <script src="../js/learn.js"></script>
    <script src="../js/hugo-learn.js"></script>
    
        
            <script src="../mermaid/mermaid.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    
  </body>
</html>
